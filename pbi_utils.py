def generate_replace_error_list(change_type_str : str, find_type: str, replace_by : str):
    """
    Given a list of Power Query {field, type}, finds the ones that have the type /find_type/ and 
    outputs a list of {field, /replace_by/}

    examples: 
        input:
        change_type_str: '{"Position ID", type text}, {"Organization", type any}, {"Sub Team", type text}, {"Cost", type number}'
        find_type: "type number"
        replace_by: "null"
        output: {"Cost", null}

        input:
        change_type_str: '{"Position ID", type text}, {"Organization", type any}, {"Sub Team", type text}, {"Cost", type number}'
        find_type: "type text"
        replace_by: '"<ERROR>"'
        output: {"Position ID", "<ERROR>"}, {"Sub Team", "<ERROR>"}
    """
    s1 = change_type_str[2:]
    s1 = s1[:-2]
    
    pairstrs = s1.split('}, {')
    retstr = "{"
    for p in pairstrs:
        kv = p.split(", ")
        if kv[1] == find_type:
            retstr += "{" + kv[0] + ", " + replace_by + "}, "

    retstr = retstr.removesuffix(', ')
    retstr += "}"
    return retstr



if __name__ == "__main__":
    pass
    # s = '{{"Position ID", type text}, {"Stream 3 (OpCo Breakout)", type text}, {"Sub Team", type text}, {"Local Title", type text}, {"Normalized Title", type text}, {"Line Type", type text}, {"Updated Line Type", type text}, {"CoCd", type text}, {"Company", type text}, {"Cost Ctr", Int64.Type}, {"Cost Center", type text}, {"Int/Ext", type text}, {"Employee Group", type text}, {"Employee Subgroup", type text}, {"Position Status", type text}, {"Position Type", type text}, {"Common Title", type text}, {"CATS Activity: Mgmt/Innovation", type number}, {"CATS Activity: Project", type number}, {"CATS Activity: Sustain / Small Enhancements", type number}, {"Job Family", type text}, {"Job Sub-Family", type text}, {"Job Specialization", type text}, {"Job Specialization Brief", type text}, {"Job Level Brief", type text}, {"Manager Name", type text}, {"Employee Work Location", type text}, {"Stream", type text}, {"GL Stream", type text}, {"Stream 2 (Analysis)", type text}, {"Co-Pilot Stream", type text}, {"Function", type text}, {"OpCo", type text}, {"Organization", type text}, {"NW Ring Fenced", type text}, {"Production Line", type any}, {"FTS", type any}, {"Product Group (If applicable)", type text}, {"Primary Role Performed", type text}, {"Secondary Role Performed", type text}, {"Job Description (Additional Context)", type text}, {"Job Level", type text}, {"% Time Spent on Global Work", type any}, {"COTS (Commercial Off the Shelf) vs Nestle Home Grown Apps", type text}, {"Interaction w/ Business", type text}, {"US Time Zone Dependent?", type text}, {"New Resource Transition Effort", type text}, {"Specialized / Technical Skillset and Tools", type text}, {"Business Knowledge ", type text}, {"Comments", type text}, {"Future Disposition", type text}, {"Additional Comments", type text}, {"Incumbent Decision Position IDs", type text}, {"Future Internal vs External", type text}, {"Future Location (US / CA / MX / Other)", type text}, {"Work Location", type text}, {"Future Job Name ", type text}, {"Future Job Level Description (Select Future Job Name First)", type text}, {"Future Job Title (Auto-populated)", type text}, {"Job Level#(lf)(Auto-populated)", type text}, {"Transition ID (TP - Partner; TE-Internal)#(lf)Unique identifier for grouping similar transition work", type text}, {"Future Manager - Future Position ID", type text}, {"Future State OpCo ", type text}, {"Future Stream", type text}, {"Future Product Group", type text}, {"Future OpCo Dedication", type text}, {"Near-Receiver", type text}, {"Embedded in Which Stream?", type any}, {"Extra Column2", type any}, {"Extra Column3", type any}, {"Extra Column4", type any}, {"Future Position ID", type text}, {"New Position Start Date (MM/DD/YYYY)", type date}, {"Transition Period (days)", Int64.Type}, {"Departure Date (MM/DD/YYYY)", type date}, {"Int vs Ext vs MS", type text}, {"Currency", type text}, {"Annual Salary", type number}, {"Bonus Target", type number}, {"Loaded Costs (Salary+ Bonus+ Tax&Benefits, NOT LTIP)", type number}, {"LTIP Bonus Target %", type number}, {"Contingent Worker Hourly Rate", type number}, {"Fully Loaded Cost Normalized", type number}, {"Final Current State Costs", type number}, {"OpCo Standardized", type text}, {"OpCo Consolidated", type text}, {"Normalized Work Location", type text}, {"Opex %", type number}, {"Capex %", type number}, {"Current Capex Costs", type number}, {"Current Opex Costs", type number}, {"Open Position Start Date Impact", type any}, {"Current Opex: 2021", type number}, {"Current Opex: 2022", type number}, {"Current Opex: 2023", Int64.Type}, {"Current Opex: 2024", Int64.Type}, {"Current Opex: 2025", Int64.Type}, {"Current Opex: 2026", Int64.Type}, {"Total Current Opex & Capex: 2021", type number}, {"Total Current Opex & Capex: 2022", type number}, {"Total Current Opex & Capex: 2023", Int64.Type}, {"Total Current Opex & Capex: 2024", Int64.Type}, {"Total Current Opex & Capex: 2025", Int64.Type}, {"Total Current Opex & Capex: 2026", Int64.Type}, {"Job Level Range (MX Ref Mapping)", type text}, {"Job Level Range (New Position) (MX Ref Mapping)", type text}, {"Stream Mapping (New Position) (MX Ref Mapping)", type any}, {"Final Position Disposition", type text}, {"Future Opex Cost (Run)", type number}, {"Future Opex: 2021", type number}, {"Future Opex: 2022", type number}, {"Future Opex: 2023", type number}, {"Future Opex: 2024", type number}, {"Future Opex: 2025", type number}, {"Future Opex: 2026", type number}, {"Future State Capex Costs", type number}, {"Total Future Opex & Capex", type number}, {"Total Future Opex & Capex: 2021", type number}, {"Total Future Opex & Capex: 2022", type number}, {"Total Future Opex & Capex: 2023", type number}, {"Total Future Opex & Capex: 2024", type number}, {"Total Future Opex & Capex: 2025", type number}, {"Total Future Opex & Capex: 2026", type number}, {"Retain", type number}, {"Eliminate", Int64.Type}, {"Outsource to MSP", type number}, {"Retain - Relocate to Mexico", type number}, {"Repurpose Existing Position", type any}, {"Capex Savings", type number}, {"Opex Savings (Run)", type number}, {"Opex Savings: 2021", type number}, {"Opex Savings: 2022", type number}, {"Opex Savings: 2023", type number}, {"Opex Savings: 2024", type number}, {"Opex Savings: 2025", type number}, {"Opex Savings: 2026", type number}, {"Total One Time Transition Cost", type number}, {"Restructuring - Severance", type number}, {"Restructuring - PTO Cashout", Int64.Type}, {"Restructuring - Outplacement", Int64.Type}, {"Restructuring – relocation (from US to MX)", type number}, {"Restructuring – relocation (new hires from LATAM to MX)", type number}, {"Transition cost – ramp up MX internal", Int64.Type}, {"Scope", type text}, {"Leadership Team Flag", type text}, {"Current + Future 2021", type number}, {"Current + Future 2022", type number}, {"Current + Future 2023", type number}, {"Current + Future 2024", type number}, {"Ramp Down 2021", type number}, {"Ramp Down 2022", type number}, {"Ramp Down 2023", type number}, {"Ramp Down 2024", type number}, {"VEREO Assumption", type text}}'
    # print(generate_replace_error_numbers(s, "type number", '0'))

    # s = '{{"Position ID", type text}, {"Stream 3 (OpCo Breakout)", type text}, {"Sub Team", type text}, {"Local Title", type text}, {"Normalized Title", type text}, {"Line Type", type text}, {"Updated Line Type", type text}, {"CoCd", type text}, {"Company", type text}, {"Cost Ctr", type number}, {"Cost Center", type text}, {"Int/Ext", type text}, {"Employee Group", type text}, {"Employee Subgroup", type text}, {"Position Status", type text}, {"Position Type", type text}, {"Common Title", type text}, {"CATS Activity: Mgmt/Innovation", type number}, {"CATS Activity: Project", type number}, {"CATS Activity: Sustain / Small Enhancements", type number}, {"Job Family", type text}, {"Job Sub-Family", type text}, {"Job Specialization", type text}, {"Job Specialization Brief", type text}, {"Job Level Brief", type text}, {"Manager Name", type text}, {"Employee Work Location", type text}, {"Stream", type text}, {"GL Stream", type text}, {"Stream 2 (Analysis)", type text}, {"Co-Pilot Stream", type text}, {"Function", type text}, {"OpCo", type text}, {"Organization", type text}, {"NW Ring Fenced", type text}, {"Production Line", type any}, {"FTS", type any}, {"Product Group (If applicable)", type text}, {"Primary Role Performed", type text}, {"Secondary Role Performed", type text}, {"Job Description (Additional Context)", type text}, {"Job Level", type text}, {"% Time Spent on Global Work", type any}, {"COTS (Commercial Off the Shelf) vs Nestle Home Grown Apps", type text}, {"Interaction w/ Business", type text}, {"US Time Zone Dependent?", type text}, {"New Resource Transition Effort", type text}, {"Specialized / Technical Skillset and Tools", type text}, {"Business Knowledge ", type text}, {"Comments", type text}, {"Future Disposition", type text}, {"Additional Comments", type text}, {"Incumbent Decision Position IDs", type text}, {"Future Internal vs External", type text}, {"Future Location (US / CA / MX / Other)", type text}, {"Work Location", type text}, {"Future Job Name ", type text}, {"Future Job Level Description (Select Future Job Name First)", type text}, {"Future Job Title (Auto-populated)", type text}, {"Job Level#(lf)(Auto-populated)", type text}, {"Transition ID (TP - Partner; TE-Internal)#(lf)Unique identifier for grouping similar transition work", type text}, {"Future Manager - Future Position ID", type text}, {"Future State OpCo ", type text}, {"Future Stream", type text}, {"Future Product Group", type text}, {"Future OpCo Dedication", type text}, {"Near-Receiver", type text}, {"Embedded in Which Stream?", type text}, {"Future Position ID", type text}, {"New Position Start Date (MM/DD/YYYY)", type date}, {"Transition Period (days)", type number}, {"Departure Date (MM/DD/YYYY)", type date}, {"Int vs Ext vs MS", type text}, {"Currency", type text}, {"Annual Salary", type number}, {"Bonus Target", type number}, {"Loaded Costs (Salary+ Bonus+ Tax&Benefits, NOT LTIP)", type number}, {"LTIP Bonus Target %", type number}, {"Contingent Worker Hourly Rate", type number}, {"Fully Loaded Cost Normalized", type number}, {"Final Current State Costs", type number}, {"OpCo Standardized", type text}, {"OpCo Consolidated", type text}, {"Normalized Work Location", type text}, {"Opex %", type number}, {"Capex %", type number}, {"Current Capex Costs", type number}, {"Current Opex Costs", type number}, {"Open Position Start Date Impact", type any}, {"Current Opex: 2021", type number}, {"Current Opex: 2022", type number}, {"Current Opex: 2023", type number}, {"Current Opex: 2024", type number}, {"Current Opex: 2025", type number}, {"Current Opex: 2026", type number}, {"Total Current Opex & Capex: 2021", type number}, {"Total Current Opex & Capex: 2022", type number}, {"Total Current Opex & Capex: 2023", type number}, {"Total Current Opex & Capex: 2024", type number}, {"Total Current Opex & Capex: 2025", type number}, {"Total Current Opex & Capex: 2026", type number}, {"Job Level Range (MX Ref Mapping)", type text}, {"Job Level Range (New Position) (MX Ref Mapping)", type text}, {"Final Position Disposition", type text}, {"Future Opex Cost (Run)", type number}, {"Future Opex: 2021", type number}, {"Future Opex: 2022", type number}, {"Future Opex: 2023", type number}, {"Future Opex: 2024", type number}, {"Future Opex: 2025", type number}, {"Future Opex: 2026", type number}, {"Future State Capex Costs", type number}, {"Total Future Opex & Capex", type number}, {"Total Future Opex & Capex: 2021", type number}, {"Total Future Opex & Capex: 2022", type number}, {"Total Future Opex & Capex: 2023", type number}, {"Total Future Opex & Capex: 2024", type number}, {"Total Future Opex & Capex: 2025", type number}, {"Total Future Opex & Capex: 2026", type number}, {"Retain", type number}, {"Eliminate", type number}, {"Outsource to MSP", type number}, {"Retain - Relocate to Mexico", type number}, {"Repurpose Existing Position", type any}, {"Capex Savings", type number}, {"Opex Savings (Run)", type number}, {"Opex Savings: 2021", type number}, {"Opex Savings: 2022", type number}, {"Opex Savings: 2023", type number}, {"Opex Savings: 2024", type number}, {"Opex Savings: 2025", type number}, {"Opex Savings: 2026", type number}, {"Total One Time Transition Cost", type number}, {"Restructuring - Severance", type number}, {"Restructuring - Outplacement", type number}, {"Restructuring – relocation (from US to MX)", type number}, {"Restructuring – relocation (new hires from LATAM to MX)", type number}, {"Transition cost – ramp up MX internal", type number}, {"Scope", type text}, {"Leadership Team Flag", type text}, {"Current + Future 2021", type number}, {"Current + Future 2022", type number}, {"Current + Future 2023", type number}, {"Current + Future 2024", type number}}'
    # print("text: ", generate_replace_error_numbers(s, "type text", '"<ERROR>"'))
    # print("any: ", generate_replace_error_numbers(s, "type any", '"<ERROR>"'))
    # print("numer: ", generate_replace_error_numbers(s, "type number", '0'))
    # print("Int64.Type: ", generate_replace_error_numbers(s, "Int64.Type", '0'))
